æ‹–æ”¾ï¼ˆdrap && dropï¼‰å®ƒè¡¨ç¤ºï¼šæŠ“å»å¯¹è±¡ä»¥åæ‹–æ”¾åˆ°å¦ä¸€ä¸ªä½ç½®ã€‚ç›®å‰ï¼Œå®ƒæ˜¯HTML5æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚
æ‹–æ”¾çš„æµç¨‹å¯¹åº”çš„äº‹ä»¶
æˆ‘ä»¬å…ˆçœ‹ä¸‹æ‹–æ”¾çš„æµç¨‹ï¼š
é€‰ä¸­ --->  æ‹–åŠ¨  ---> é‡Šæ”¾

ç„¶åï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥çœ‹ä¸‹è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¼šå‘ç”Ÿçš„äº‹æƒ…ã€‚
é€‰ä¸­
æµè§ˆå™¨ä¸­ï¼Œæœ‰ä¸‰ç§å…ƒç´ ï¼Œé»˜è®¤æ˜¯å¯ä»¥è¢«æ‹–åŠ¨çš„ï¼Œå®ƒä»¬çš„draggableå±æ€§è‡ªåŠ¨è¢«è®¾ç½®æˆäº†trueï¼Œå®ƒä»¬æ˜¯ï¼š
1. è¢«é€‰ä¸­åçš„æ–‡æœ¬ï¼›
2. å›¾ç‰‡ï¼›
3. é“¾æ¥
 å…¶ä»–å…ƒç´ è¦è½¬æˆå¯æ‹–åŠ¨å…ƒç´ ï¼Œå¿…é¡»æ·»åŠ draggable="true"ï¼Œå¦‚ï¼š
<div draggable="true"></div>

æ³¨æ„ï¼šè¿™é‡Œä¸èƒ½ç•¥å†™ï¼Œå¦‚å†™æˆï¼š
<div draggable></div>

æ˜¯æ— æ•ˆçš„ã€‚ 
draggableå±æ€§ï¼šè®¾ç½®å…ƒç´ æ˜¯å¦å¯æ‹–åŠ¨ã€‚è¯­æ³•ï¼š<element draggable="true | false | auto" >

- true: å¯ä»¥æ‹–åŠ¨
- false: ç¦æ­¢æ‹–åŠ¨
- auto: è·Ÿéšæµè§ˆå™¨å®šä¹‰æ˜¯å¦å¯ä»¥æ‹–åŠ¨
æ‹–åŠ¨
æ¯ä¸€ä¸ªå¯æ‹–åŠ¨çš„å…ƒç´ ï¼Œåœ¨æ‹–åŠ¨è¿‡ç¨‹ä¸­ï¼Œéƒ½ä¼šç»å†ä¸‰ä¸ªè¿‡ç¨‹ï¼Œæ‹–åŠ¨å¼€å§‹-->æ‹–åŠ¨è¿‡ç¨‹ä¸­--> æ‹–åŠ¨ç»“æŸã€‚
å…·ä½“å¯å‚è€ƒmdn
é’ˆå¯¹å¯¹è±¡
äº‹ä»¶åç§°
è¯´æ˜
è¢«æ‹–åŠ¨çš„å…ƒç´ 
dragstart
åœ¨å…ƒç´ å¼€å§‹è¢«æ‹–åŠ¨æ—¶å€™è§¦å‘

drag
åœ¨å…ƒç´ è¢«æ‹–åŠ¨æ—¶åå¤è§¦å‘

dragend
åœ¨æ‹–åŠ¨æ“ä½œå®Œæˆæ—¶è§¦å‘
ç›®çš„åœ°å…ƒç´ 
dragenter
å½“è¢«æ‹–åŠ¨å…ƒç´ è¿›å…¥ç›®çš„åœ°å…ƒç´ æ‰€å æ®çš„å±å¹•ç©ºé—´æ—¶è§¦å‘

dragover
å½“è¢«æ‹–åŠ¨å…ƒç´ åœ¨ç›®çš„åœ°å…ƒç´ å†…æ—¶è§¦å‘

dragleave
å½“è¢«æ‹–åŠ¨å…ƒç´ æ²¡æœ‰æ”¾ä¸‹å°±ç¦»å¼€ç›®çš„åœ°å…ƒç´ æ—¶è§¦å‘

dragenterå’Œdragoveräº‹ä»¶çš„é»˜è®¤è¡Œä¸ºæ˜¯æ‹’ç»æ¥å—ä»»ä½•è¢«æ‹–æ”¾çš„å…ƒç´ ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¿…é¡»é˜»æ­¢æµè§ˆå™¨è¿™ç§é»˜è®¤è¡Œä¸ºã€‚e.preventDefault();
é‡Šæ”¾
åˆ°è¾¾ç›®çš„åœ°ä¹‹åï¼Œé‡Šæ”¾å…ƒç´ äº‹ä»¶
é’ˆå¯¹å¯¹è±¡
äº‹ä»¶åç§°
è¯´æ˜
ç›®çš„åœ°å¯¹è±¡
drop
å½“è¢«æ‹–åŠ¨å…ƒç´ åœ¨ç›®çš„åœ°å…ƒç´ é‡Œæ”¾ä¸‹æ—¶è§¦å‘ï¼Œä¸€èˆ¬éœ€è¦å–æ¶ˆæµè§ˆå™¨é»˜è®¤è¡Œä¸º

é€‰ä¸­æ‹–åŠ¨é‡Šæ”¾ä¾‹å­
```html
<!DOCTYPE HTML>
<html>

<head>
    <title>æ‹–æ”¾ç¤ºä¾‹-æ–‡æœ¬</title>
</head>
<style>
.src {
    display: flex;
}

.dropabled {
    flex: 1;
}

.txt {
    color: green;
}

.img {
    width: 100px;
    height: 100px;
    border: 1px solid gray;
}

.target {
    width: 200px;
    height: 200px;
    line-height: 200px;
    text-align: center;
    border: 1px solid gray;
    color: red;
}
</style>

<body>
    <div class="src">
        <div class="dragabled">
          æ‰€æœ‰çš„æ–‡å­—éƒ½å¯æ‹–æ‹½ã€‚
            <div class="txt" >
                <p draggable="true" id="txt">æ­¤æ®µæ–‡å­—è®¾ç½®äº†å±æ€§draggable="true"</p>  
            </div>
            <div class="url" id="url">
                <a href="http://www.com" target="_blank">æˆ‘æ˜¯url:http://wom</a>
            </div>
            <img class="img" id="tupian1" src="https://ww.c" alt="å›¾ç‰‡1" />
            <img class="img" id="tupian2" src="http://n.sin.jpg" alt="å›¾ç‰‡2" />
        </div>
        <div id='target' class="dropabled target">Drop Here</div>
    </div>
    <script>
      window.currentdrag = '';
        var dragSrc = document.getElementById('txt')
        var target = document.getElementById('target')

        dragSrc.ondragstart = handle_start
        dragSrc.ondrag = handle_drag
        dragSrc.ondragend = handle_end

        function handle_start(e) {
          console.log('dragstart-åœ¨å…ƒç´ å¼€å§‹è¢«æ‹–åŠ¨æ—¶å€™è§¦å‘')
          window.currentdrag = `è¿™æ˜¯æ˜¯æ‹–æ‹½çš„å…ƒç´ ${e.target.innerHTML}`;
        }

      function handle_drag() {
            console.log('drag-åœ¨å…ƒç´ è¢«æ‹–åŠ¨æ—¶å€™åå¤è§¦å‘')
        }

      function handle_end() {
            console.log('dragend-åœ¨æ‹–åŠ¨æ“ä½œå®Œæˆæ—¶è§¦å‘')
            // æ¸…ç©ºæ‹–æ‹½å…ƒç´ 
            window.currentdrag = '';
        }


        target.ondragenter = handle_enter
        target.ondragover = handle_over
        target.ondragleave = handle_leave

        target.ondrop = handle_drop

        function handle_enter(e) {
            console.log('handle_enter-å½“å…ƒç´ è¿›å…¥ç›®çš„åœ°æ—¶è§¦å‘')
            // é˜»æ­¢æµè§ˆå™¨é»˜è®¤è¡Œä¸º
            e.preventDefault()
        }

        function handle_over(e) {
            console.log('handle_over-å½“å…ƒç´ åœ¨ç›®çš„åœ°æ—¶è§¦å‘')
            // é˜»æ­¢æµè§ˆå™¨é»˜è®¤è¡Œä¸º
            e.preventDefault()
        }

        function handle_leave(e) {
            console.log('handle_leave-å½“å…ƒç´ ç¦»å¼€ç›®çš„åœ°æ—¶è§¦å‘')
            // é˜»æ­¢æµè§ˆå™¨é»˜è®¤è¡Œä¸º
            // e.preventDefault()
        }

        function handle_drop(e) {
            console.log('handle_drop-å½“å…ƒç´ åœ¨ç›®çš„åœ°æ”¾ä¸‹æ—¶è§¦å‘')
            target.innerHTML = ''
            target.append(`${window.currentdrag ? window.currentdrag: `æ‹–æ‹½é»˜è®¤çš„å›¾ç‰‡/é“¾æ¥${Math.random()}`}-æ‹–æ”¾è§¦å‘çš„äº‹ä»¶ã€‚`)
            e.preventDefault()
        }
    </script>
</body>

</html>
```

åœ¨æ•´ä¸ªæ‹–æ”¾è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä»¥ä¸Šè¯´çš„æ˜¯è¡¨é¢ç°è±¡ï¼Œäº‹ä»¶è¿‡ç¨‹å†…éƒ¨è¿˜ä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…å‘¢ï¼Ÿè¯·çœ‹ä¸‹é¢ğŸ‘‡çš„DataTransferå¯¹è±¡ã€‚
### DataTransferå¯¹è±¡
 ä¸€ä¸ªå®Œæ•´çš„æ‹–æ”¾æ“ä½œï¼Œé™¤äº†æ‹–åŠ¨ä¸€ä¸ªå…ƒç´ ï¼Œåœ¨æŒ‡å®šåŒºåŸŸé‡Šæ”¾ä¹‹å¤–ï¼Œè¿˜æœ‰æœ€é‡è¦çš„ä¸€æ­¥ï¼Œå°±æ˜¯å°†å…ƒç´ æºå¸¦çš„ä¿¡æ¯åœ¨è¢«é‡Šæ”¾åŒºåŸŸä¸­å±•ç¤ºã€‚
 æ¯”å¦‚ï¼Œæ‹–æ”¾ä¸€å¼ å›¾ç‰‡ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯è·å–åˆ°è¢«æ‹–åŠ¨çš„å›¾ç‰‡srcå±æ€§å€¼ï¼Œå¹¶åœ¨é‡Šæ”¾æ—¶ï¼Œåœ¨é‡Šæ”¾åŒºåŸŸå±•ç¤ºä¸€å¼ ç›¸åŒsrcçš„å›¾ç‰‡ã€‚
 è€Œè¿™ä¸ªä¿¡æ¯ï¼Œå°±å­˜å‚¨åœ¨DataTransferå¯¹è±¡ä¸­ã€‚
 å¯¹äºéé»˜è®¤å¯æ‹–æ”¾å…ƒç´ æ¥è¯´ï¼Œå…¶åŒ…å«çš„ä¿¡æ¯éœ€è¦åœ¨dragstartäº‹ä»¶ä¸­è®¾ç½®ï¼Œä½¿ç”¨DataTransfer.setData()ï¼Œå¦‚ï¼š
 ```js
dragItem.ondragstart = e => {
  e.dataTransfer.setData('text/plain', 'drag info');
}
```

å¦‚æœå¸Œæœ›æ‹–åŠ¨æ—¶ï¼Œå±•ç¤ºè‡ªå®šä¹‰çš„å›¾ç‰‡ï¼Œè¿˜å¯ä»¥è°ƒç”¨dataTransfer.setDragImageï¼Œå¦‚ï¼š

```js
dragItem1.ondragstart = e => {
  const img = new Image(); 
  img.src = 'img_url.jpg'; 
  e.dataTransfer.setDragImage(img, 0, 0);
}
```
åœ¨dropäº‹ä»¶ä¸­ï¼Œå¯ä»¥å–å¾—æ‹–æ”¾å…ƒç´ çš„ä¿¡æ¯ï¼Œå¹¶å°†æŒ‡å®šä¿¡æ¯é€šè¿‡domæ“ä½œï¼Œå±•ç¤ºåœ¨ç‰¹å®šåŒºåŸŸï¼Œå¦‚ï¼š
```js
dropArea.ondrop = e => {
  e.preventDefault();
  const data = e.dataTransfer.getData("text/plain");
   //æ¸…é™¤æ‹–æ›³å…ƒç´ çš„ç¼“å­˜
  e.dataTransfer.clearData();
  const div = document.createElement("div");
  div.textContent = data;
  e.target.appendChild(div);
}
```
åœ¨DataTransferå¯¹è±¡è¿˜æœ‰ä¸€å¯¹å±æ€§ï¼Œç”¨æ¥ç¡®ä¿é‡Šæ”¾åŒºåŸŸåªèƒ½é‡Šæ”¾ç‰¹å®šç±»å‹çš„æ‹–æ‹½å…ƒç´ ï¼Œå³dropEffectå’ŒeffectAllowedã€‚
 effectAllowedåªèƒ½åœ¨dragstartäº‹ä»¶ä¸­è®¾ç½®ï¼Œåœ¨dragenteræˆ–dragoveräº‹ä»¶ä¸­ï¼Œéœ€è¦è®¾ç½®dropEffectçš„å€¼ä¸effectAllowedä¸€è‡´ï¼Œæ‰èƒ½è§¦å‘dropäº‹ä»¶ã€‚å¦‚ï¼š
```js
dragItem.ondragstart = e => {
  e.dataTransfer.effectAllowed = "move";
}

dropArea.ondragover = e => {
  e.preventDefault();
  e.dataTransfer.dropEffect = "move";
}
```
ä¸æ‹–æ”¾æ“ä½œæ‰€è§¦å‘çš„äº‹ä»¶åŒæ—¶æ´¾å‘çš„å¯¹è±¡æ˜¯DragEventï¼Œå®ƒæ´¾ç”ŸäºMouseEventï¼Œå…·æœ‰Eventä¸MouseEventå¯¹è±¡çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶å¢åŠ äº†dataTransferå±æ€§ã€‚è¯¥å±æ€§ç”¨äºä¿å­˜æ‹–æ”¾çš„æ•°æ®å’Œäº¤äº’ä¿¡æ¯ï¼Œè¿”å›DataTransferå¯¹è±¡ã€‚
```js
// DataTransfer dataTransfer = DragEvent.dataTransfer
```
DataTransferå¯¹è±¡å®šä¹‰çš„å±æ€§å’Œæ–¹æ³•æœ‰å¾ˆå¤šç§ï¼Œæˆ‘ä»¬çœ‹ä¸‹åˆ—å…¥æ ‡å‡†çš„å‡ ä¸ªã€‚å…¶ä»–å±æ€§åŠæ–¹æ³•ï¼Œè¯¦ç»†å¯ä»¥æŸ¥çœ‹mdn
å±æ€§
è¯´æ˜
types
åªè¯»å±æ€§ã€‚å®ƒè¿”å›ä¸€ä¸ªæˆ‘ä»¬åœ¨dragstartäº‹ä»¶ä¸­è®¾ç½®çš„æ‹–åŠ¨æ•°æ®æ ¼å¼çš„æ•°ç»„ã€‚ æ ¼å¼é¡ºåºä¸æ‹–åŠ¨æ“ä½œä¸­åŒ…å«çš„æ•°æ®é¡ºåºç›¸åŒã€‚IE10+ã€Edgeã€safari3.1ã€Firefox3.5+ å’ŒChrome4ä»¥ä¸Šæ”¯æŒè¯¥å±æ€§
files
è¿”å›æ‹–åŠ¨æ“ä½œä¸­çš„æ–‡ä»¶åˆ—è¡¨ã€‚åŒ…å«ä¸€ä¸ªåœ¨æ•°æ®ä¼ è¾“ä¸Šæ‰€æœ‰å¯ç”¨çš„æœ¬åœ°æ–‡ä»¶åˆ—è¡¨ã€‚å¦‚æœæ‹–åŠ¨æ“ä½œä¸æ¶‰åŠæ‹–åŠ¨æ–‡ä»¶ï¼Œæ­¤å±æ€§æ˜¯ä¸€ä¸ªç©ºåˆ—è¡¨ã€‚
dropEffect
è·å–å½“å‰é€‰å®šçš„æ‹–æ”¾æ“ä½œçš„ç±»å‹æˆ–å°†æ“ä½œè®¾ç½®ä¸ºæ–°ç±»å‹ã€‚å®ƒåº”è¯¥å§‹ç»ˆè®¾ç½®æˆeffectAllowedçš„å¯èƒ½å€¼ä¹‹ä¸€ã€noneã€moveã€copyã€linkã€‘ã€‚dragoveräº‹ä»¶å¤„ç†ç¨‹åºä¸­é’ˆå¯¹æ”¾ç½®ç›®æ ‡æ¥è®¾ç½®dropEffectã€‚
effectAllowed
æŒ‡å®šæ‹–æ”¾æ“ä½œæ‰€å…è®¸çš„æ•ˆæœã€‚å¿…é¡»æ˜¯å…¶ä¸­ä¹‹ä¸€ã€ none, copy, copyLink, copyMove, link, linkMove, move, all, uninitializedã€‘é»˜è®¤ä¸ºuninitialized è¡¨ç¤ºå…è®¸æ‰€æœ‰çš„æ•ˆæœã€‚ondragstartå¤„ç†ç¨‹åºä¸­è®¾ç½®effectAllowedå±æ€§

æ–¹æ³•
è¯´æ˜
void setData(format, data) 
å°†æ‹–åŠ¨æ“ä½œçš„æ‹–åŠ¨æ•°æ®è®¾ç½®ä¸ºæŒ‡å®šçš„æ•°æ®å’Œç±»å‹ã€‚formatå¯ä»¥æ˜¯MIMEç±»å‹
 String getData(format) 
è¿”å›æŒ‡å®šæ ¼å¼çš„æ•°æ®ï¼Œformatä¸setData()ä¸­ä¸€è‡´
 void clearData([format]) 
åˆ é™¤ç»™å®šç±»å‹çš„æ‹–åŠ¨æ“ä½œçš„æ•°æ®ã€‚å¦‚æœç»™å®šç±»å‹çš„æ•°æ®ä¸å­˜åœ¨ï¼Œæ­¤æ–¹æ³•ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚å¦‚æœä¸ç»™å®šå‚æ•°ï¼Œåˆ™åˆ é™¤æ‰€æœ‰ç±»å‹çš„æ•°æ®ã€‚
 void setDragImage(img, xOffset, yOffset) 
æŒ‡å®šä¸€å‰¯å›¾åƒï¼Œå½“æ‹–åŠ¨å‘ç”Ÿæ—¶ï¼Œæ˜¾ç¤ºåœ¨å…‰æ ‡ä¸‹æ–¹ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ä¸ç”¨è®¾ç½®ï¼Œå› ä¸ºè¢«æ‹–åŠ¨çš„èŠ‚ç‚¹è¢«åˆ›å»ºæˆé»˜è®¤å›¾ç‰‡ã€‚x,yå‚æ•°åˆ†åˆ«æŒ‡ç¤ºå›¾åƒçš„æ°´å¹³ã€å‚ç›´åç§»é‡

IE10åŠä¹‹å‰ç‰ˆæœ¬ï¼Œä¸æ”¯æŒæ‰©å±•çš„MIMEç±»å‹å
 Firefox 5ç‰ˆæœ¬ä¹‹å‰ï¼Œä¸èƒ½æ­£ç¡®çš„å°†urlå’Œtextæ˜ å°„ä¸ºtext/uri-list å’Œtext/plain 
var dataTransfer = event.dataTransfer; 
// è¯»å–æ–‡æœ¬, 
var text = dataTransfer.getData("Text"); 
// è¯»å–URL, 
var url = dataTransfer.getData("url") || dataTransfer.getData("text/uri-list"); 

æµè§ˆå™¨æ”¯æŒç¨‹åº¦
Method of easily dragging and dropping elements on a page, requiring minimal JavaScript.
è¦æ±‚æœ€å°‘çš„jsï¼Œå®ç°æ‹–æ‹½é¡µé¢å…ƒç´ çš„ç®€å•æ–¹æ³•

- dataTransfer.items åªæœ‰Chromeæ”¯æŒ
- dropzoneå±æ€§ï¼Œç›®å‰æ²¡æœ‰æµè§ˆå™¨æ”¯æŒ
- Firefoxæ”¯æŒ.setDragImageä»»ä½•ç±»å‹çš„DOMå…ƒç´ ã€‚Chromeå¿…é¡»æœ‰HTMLImageElementæˆ–è€…ä»»ä½•DOMå…ƒç´ ï¼Œè¯¥DOMå…ƒç´ é™„åŠ åˆ°DOM å’Œæµè§ˆå™¨çš„.setDragImageè§†å£(viewport)å†…ã€‚
 1.éƒ¨åˆ†æ”¯æŒæ˜¯æŒ‡ä¸æ”¯æŒdataTransfer.files æˆ–è€… .typeså¯¹è±¡
 2.éƒ¨åˆ†æ”¯æŒæ˜¯æŒ‡ä¸æ”¯æŒ.setDragImage
 3.éƒ¨åˆ†æ”¯æŒæ˜¯æŒ‡dataTransfer.setData / getData çš„æœ‰é™æ”¯æŒæ ¼å¼