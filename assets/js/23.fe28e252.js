(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{259:function(t,e,s){"use strict";s.r(e);var _=s(0),v=Object(_.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),s("blockquote",[s("p",[s("a",{attrs:{href:"http://litten.me/2017/07/09/prevent-spiders/",target:"_blank",rel:"noopener noreferrer"}},[t._v("各大前端巨头反爬虫策略"),s("OutboundLink")],1)])]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),s("p",[t._v("但是世界上没有一个网站，能做到完美地反爬虫。")]),t._v(" "),s("p",[t._v("如果页面希望能在用户面前正常展示，同时又不给爬虫机会，就必须要做到识别真人与机器人。因此工程师们做了各种尝试，这些策略大多采用于后端，也是目前比较常规单有效的手段，比如：")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),s("p",[t._v("所以我们说，100%的反爬虫策略？不存在的。")]),t._v(" "),s("p",[t._v("更多的是体力活，是个难易程度的问题。")]),t._v(" "),s("p",[t._v("不过作为前端工程师，我们可以增加一下游戏难度，设计出一些很(sang)有(xin)意(bing)思(kuang)的反爬虫策略。")]),t._v(" "),t._m(7),t._v(" "),s("p",[t._v("3.1 FONT-FACE拼凑式\n例子：猫眼电影")]),t._v(" "),s("p",[t._v("猫眼电影里，对于票房数据，展示的并不是纯粹的数字。\n页面使用了font-face定义了字符集，并通过unicode去映射展示。也就是说，除去图像识别，必须同时爬取字符集，才能识别出数字。")]),t._v(" "),s("p",[t._v("并且，每次刷新页面，字符集的url都是有变化的，无疑更大难度地增加了爬取成本。")]),t._v(" "),s("p",[t._v("3.2 BACKGROUND拼凑式\n例子：美团")]),t._v(" "),s("p",[t._v("与font的策略类似，美团里用到的是background拼凑。数字其实是图片，根据不同的background偏移，显示出不同的字符。")]),t._v(" "),s("p",[t._v("并且不同页面，图片的字符排序也是有区别的。不过理论上只需生成0-9与小数点，为何有重复字符就不是很懂。")]),t._v(" "),s("p",[t._v("页面A：")]),t._v(" "),s("p",[t._v("页面B：")]),t._v(" "),s("p",[t._v("3.3 字符穿插式\n例子：微信公众号文章")]),t._v(" "),s("p",[t._v("某些微信公众号的文章里，穿插了各种迷之字符，并且通过样式把这些字符隐藏掉。\n这种方式虽然令人震惊…但其实没有太大的识别与过滤难度，甚至可以做得更好，不过也算是一种脑洞吧。")]),t._v(" "),s("p",[t._v("对了，我的手机流量可以找谁报销吗？")]),t._v(" "),s("p",[t._v("3.4 伪元素隐藏式\n例子：汽车之家")]),t._v(" "),s("p",[t._v("汽车之家里，把关键的厂商信息，做到了伪元素的content里。\n这也是一种思路：爬取网页，必须得解析css，需要拿到伪元素的content，这就提升了爬虫的难度。")]),t._v(" "),s("p",[t._v("3.5 元素定位覆盖式\n例子：去哪儿")]),t._v(" "),s("p",[t._v("还有热爱数学的去哪儿，对于一个4位数字的机票价格，先用四个i标签渲染，再用两个b标签去绝对定位偏移量，覆盖故意展示错误的i标签，最后在视觉上形成正确的价格…")]),t._v(" "),s("p",[t._v("这说明爬虫会解析css还不行，还得会做数学题。")]),t._v(" "),s("p",[t._v("3.6 IFRAME异步加载式\n例子：网易云音乐(动态加载数据)")]),t._v(" "),s("p",[t._v("网易云音乐页面一打开，html源码里几乎只有一个iframe，并且它的src是空白的：about:blank。接着js开始运行，把整个页面的框架异步塞到了iframe里面…")]),t._v(" "),s("p",[t._v("不过这个方式带来的难度并不大，只是在异步与iframe处理上绕了个弯（或者有其他原因，不完全是基于反爬虫考虑），无论你是用selenium还是phantom，都有API可以拿到iframe里面的content信息。")]),t._v(" "),s("p",[t._v("3.7 字符分割式\n例子：全网代理IP")]),t._v(" "),s("p",[t._v("在一些展示代理IP信息的页面，对于IP的保护也是大费周折。")]),t._v(" "),s("p",[t._v("他们会先把IP的数字与符号分割成dom节点，再在中间插入迷惑人的数字，如果爬虫不知道这个策略，还会以为自己成功拿到了数值；不过如果爬虫注意到，就很好解决了。")]),t._v(" "),s("p",[t._v("3.8 字符集替换式\n例子：去哪儿移动侧")]),t._v(" "),s("p",[t._v("同样会欺骗爬虫的还有去哪儿的移动版。")]),t._v(" "),s("p",[t._v("html里明明写的3211，视觉上展示的却是1233。原来他们重新定义了字符集，3与1的顺序刚好调换得来的结果…")]),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),s("p",[t._v("考虑了两种情况\n1、js更改了数值。")]),t._v(" "),t._m(12),t._v(" "),s("p",[t._v("2、css更改了数值")]),t._v(" "),s("p",[t._v("但是css只是样式表只能改变样式并不能更改数据，这是我看到class")]),t._v(" "),t._m(13),t._m(14)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"反击爬虫，前端工程师的脑洞"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#反击爬虫，前端工程师的脑洞","aria-hidden":"true"}},[this._v("#")]),this._v(" 反击爬虫，前端工程师的脑洞")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"前言"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前言","aria-hidden":"true"}},[this._v("#")]),this._v(" 前言")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("对于一张网页，我们往往希望它结构良好，内容清晰，这样搜索引擎才能准确认知它。\n而反过来，又有一些情景，我们不希望内容能被轻易获取，比方说电商网站交易额，教育网站的题目等。因为这些内容，往往是一个产品的生命线，必须做到有效的保护。这就是"),e("code",[this._v("爬虫与反爬虫")]),this._v("这一话题的由来。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"常见的反爬虫策略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#常见的反爬虫策略","aria-hidden":"true"}},[this._v("#")]),this._v(" 常见的反爬虫策略")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("User-Agent + Referer检测")]),this._v(" "),e("li",[this._v("账号及Cookie验证")]),this._v(" "),e("li",[this._v("验证码")]),this._v(" "),e("li",[this._v("IP限制频次")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"而爬虫是可以无限逼近于真人的，比如："}},[e("a",{staticClass:"header-anchor",attrs:{href:"#而爬虫是可以无限逼近于真人的，比如：","aria-hidden":"true"}},[this._v("#")]),this._v(" 而爬虫是可以无限逼近于真人的，比如：")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("chrome headless或phantomjs来模拟浏览器环境")]),this._v(" "),e("li",[this._v("tesseract识别验证码")]),this._v(" "),e("li",[this._v("代理IP淘宝就能买到")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"前端与反爬虫"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#前端与反爬虫","aria-hidden":"true"}},[this._v("#")]),this._v(" 前端与反爬虫")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"字体反爬"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#字体反爬","aria-hidden":"true"}},[this._v("#")]),this._v(" 字体反爬")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("下载反爬字体的"),e("code",[this._v(".eot")]),this._v("文件；然后打开百度字体编辑器"),e("code",[this._v("fontEditor")]),this._v("，打开"),e("code",[this._v(".eot")]),this._v("文件；")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"网页显示与按f12查看源代码显示不一致"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#网页显示与按f12查看源代码显示不一致","aria-hidden":"true"}},[this._v("#")]),this._v(" 网页显示与按f12查看源代码显示不一致")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("比如，网页显示为 "),e("code",[this._v("200万人民币")]),this._v("；源代码则显示 "),e("code",[this._v("155万人作币")]),this._v(" ； 在网页复制的时候，也会显示 155万人作币；")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("很明显不是，因为开发者工具加载的是运行过脚本后的实际数据。")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-css extra-class"},[s("pre",{pre:!0,attrs:{class:"language-css"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".font-num")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("font-family")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"font-num"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token important"}},[t._v("!important")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[s("p",[t._v("原因： 数字发生了错位，"),s("code",[t._v("1")]),t._v("对应显示"),s("code",[t._v("2")]),t._v("，"),s("code",[t._v("5")]),t._v("对应显示"),s("code",[t._v("0")]),t._v("，"),s("code",[t._v("作")]),t._v("对应显示"),s("code",[t._v("民")])])]),t._v(" "),s("li",[s("p",[t._v("解决方案：参考字体文件映射关系；将数据进行反相解析")])])])}],!1,null,null,null);e.default=v.exports}}]);