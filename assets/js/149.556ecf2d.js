(window.webpackJsonp=window.webpackJsonp||[]).push([[149],{417:function(t,s,n){"use strict";n.r(s);var a=n(0),e=Object(a.a)({},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[t._m(0),t._v(" "),n("p",[t._v("Node.js æ€§èƒ½å¹³å° ( Node.js Performance Platformï¼ŒåŸ alinode ) æ˜¯é¢å‘æ‰€æœ‰ Node.js åº”ç”¨æä¾› æ€§èƒ½ç›‘æ§ã€å®‰å…¨æé†’ã€æ•…éšœæ’æŸ¥ã€æ€§èƒ½ä¼˜åŒ– ç­‰æœåŠ¡çš„æ•´ä½“æ€§è§£å†³æ–¹æ¡ˆï¼Œå°¤å…¶é€‚ç”¨äºä¸­å¤§å‹ Node.js åº”ç”¨ã€‚")]),t._v(" "),n("p",[t._v("egg-alinodeä¸ºeggç”¨äºæ”¯æŒalinodeçš„æ’ä»¶")]),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),t._m(4),t._v(" "),n("p",[t._v("å¦‚æœæƒ³è¦æé«˜ç³»ç»Ÿååé‡ï¼Œå°±éœ€è¦å…ˆè¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œæµ‹å‡ºç³»ç»Ÿæé™ï¼Œç„¶åå†è¿›è¡Œæ€§èƒ½è°ƒä¼˜ã€‚")]),t._v(" "),n("ul",[n("li",[t._v("ä½¿ç”¨ "),n("a",{attrs:{href:"https://jmeter.apache.org/download_jmeter.cgi",target:"_blank",rel:"noopener noreferrer"}},[t._v("JMeter"),n("OutboundLink")],1),t._v(" è¿›è¡Œæ€§èƒ½æµ‹è¯•")])]),t._v(" "),n("p",[t._v("ä¸‹è½½jmeterï¼Œç„¶åè§£å‹åˆ°ä»»æ„ç›®å½•ï¼Œæ‰§è¡Œbinæ–‡ä»¶å¤¹ä¸‹çš„ jmeter.shåœ¨å‡ºç°çš„UIç•Œé¢ä¸Šè¿›è¡Œå¯¹ä½ çš„node æœåŠ¡è¿›è¡Œç›¸åº”æµ‹è¯•ï¼Œå…·ä½“å¦‚ä½•æµ‹è¯•å¯ä»¥Googleã€‚å¯ä»¥æµ‹å‡ºç¨‹åºçš„ååé‡ã€‚")]),t._v(" "),t._m(5),t._v(" "),n("p",[t._v("å†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰æŒ‡ç”±äºç–å¿½æˆ–é”™è¯¯é€ æˆç¨‹åºæœªèƒ½é‡Šæ”¾å·²ç»ä¸å†ä½¿ç”¨çš„å†…å­˜çš„æƒ…å†µã€‚")]),t._v(" "),n("p",[t._v("å¦‚æœä¸€ä¸ªç¨‹åºå­˜åœ¨å†…å­˜æ³„éœ²ï¼Œåˆ™éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå†…å­˜å ç”¨è¶Šæ¥è¶Šæ¥ï¼Œç¨‹åºä¹Ÿå°±ä¼šè¶Šæ¥è¶Šå¡ï¼Œå¯¼è‡´ç³»ç»Ÿæ€§èƒ½ä¸‹é™ï¼Œååé‡ä¸‹é™ï¼Œå› æ­¤å¦‚æœå‘ç°ä½ çš„ç¨‹åºè¶Šæ¥è¶Šæ…¢ï¼Œé‚£å¯èƒ½å­˜åœ¨å†…å­˜æ³„éœ²é—®é¢˜ã€‚")]),t._v(" "),t._m(6),t._v(" "),n("p",[t._v("heapdumpæˆ–ä½¿ç”¨ v8-profiler")]),t._v(" "),n("p",[t._v("è¿™ä¸¤ä¸ªå·¥å…·çš„åŸç†éƒ½æ˜¯ä¸€è‡´çš„ï¼šè°ƒç”¨v8å¼•æ“æš´éœ²çš„æ¥å£ï¼š")]),t._v(" "),t._m(7),t._v(" "),n("p",[t._v("ç„¶åå°†è·å–çš„c++å¯¹è±¡æ•°æ®è½¬æ¢ä¸ºjså¯¹è±¡ã€‚")]),t._v(" "),n("p",[t._v("è¿™é‡Œæ¨èä½¿ç”¨v8-profilerå› ä¸ºå¤šä¸€ä¸ªcpuå¿«ç…§åŠŸèƒ½")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://github.com/node-inspector/v8-profiler",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-inspector/v8-profiler"),n("OutboundLink")],1)]),t._v(" "),t._m(8),t._v(" "),t._m(9),n("p",[t._v("okï¼Œç„¶åä½¿ç”¨Jmeterè¿›è¡Œå¹¶å‘æµ‹è¯•ï¼Œåœ¨åˆé€‚çš„æ—¶æœºè¯·æ±‚æœåŠ¡profileræ¥å£ï¼Œå¾—åˆ°3ä¸ªæ–‡ä»¶.")]),t._v(" "),n("p",[t._v("snapshot1.heapsnapshot")]),t._v(" "),n("p",[t._v("snapshot2.heapsnapshot")]),t._v(" "),n("p",[t._v("profiler.cpuprofile")]),t._v(" "),t._m(10),t._v(" "),n("p",[t._v("ä½¿ç”¨chrome devtool è¿›è¡Œåˆ†æ\nimage")]),t._v(" "),n("p",[t._v("ç‚¹å¼€Memoryé¢æ¿ï¼Œå·¦ä¾§è¾¹æ å³é”®loadï¼Œé€‰æ‹©åˆšæ‰çš„2ä¸ªheapsnapshotæ–‡ä»¶ï¼Œ")]),t._v(" "),n("p",[t._v("é€‰æ‹©å·¦ä¸Šè§’çš„Comparsion å³å¯¹æ¯”2æ¬¡å†…å­˜ä½¿ç”¨æƒ…å†µï¼Œä¸‹é¢æ•°æ® + å³è¡¨ç¤ºå¢é¡¹çš„å†…å­˜ï¼Œ- è¡¨ç¤ºå‡å°‘çš„ã€‚ image")]),t._v(" "),n("p",[t._v("è¿™æ ·å°±å¯ä»¥è½»æ¾çš„çŸ¥é“ä»€ä¹ˆåœ¨å¢åŠ ï¼Œå¢åŠ é‡Œå¤šå°‘ã€‚æ‰¾å‡ºå¼‚å¸¸çš„ç‚¹å¼€è¿›è¡Œåˆ†æã€‚")]),t._v(" "),n("p",[t._v("CPU image")]),t._v(" "),n("p",[t._v("æ‰“å¼€JavaScript Profiler é¢æ¿ï¼ŒåŒæ ·load cpuprofileæ–‡ä»¶ï¼Œé¢æ¿ä¼šå°†æœ€è€—æ—¶çš„æ–¹æ³•æ”¾åœ¨ä¸Šé¢ï¼Œå‰”é™¤programå’ŒGCæ¶ˆè€—ï¼Œæ£€æŸ¥æœ€è€—æ—¶çš„functionæ¥ä¼˜åŒ–ã€‚")]),t._v(" "),t._m(11),t._v(" "),n("p",[t._v("ç™»é™†alinodeï¼Œåˆ›å»ºæ–°åº”ç”¨ï¼Œåˆ›å»ºå¥½åï¼Œæ‰“å¼€ã€‚")]),t._v(" "),n("p",[t._v("heapsnapshotåˆ†æ\né€‰æ‹©ä¸Šä¼ æ–‡ä»¶ï¼Œé€‰æ‹© å †å¿«ç…§ï¼Œä¸Šä¼ åˆšæ‰çš„heapsnapshotæ–‡ä»¶")]),t._v(" "),n("p",[t._v("image")]),t._v(" "),n("p",[t._v("å®Œæˆåå¦‚ä¸‹ image")]),t._v(" "),n("p",[t._v("ç‚¹å‡»åˆ†æï¼Œä¼šæ˜¾ç¤ºå‡ºå†…å­˜æ³„éœ²å¯ç–‘ç‚¹ã€‚ğŸ‘ image")]),t._v(" "),n("p",[t._v("ç‚¹å‡»Arrayå…³é”®å­—è¿›å»æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ï¼Œå‘ç°å†…å­˜å ç”¨æ¯”ä¾‹87.35%ï¼Œå†ç‚¹å‡»å…·ä½“ä¿¡æ¯å°±å¯ä»¥çŸ¥é“å“ªå—å†…å­˜æ³„éœ²äº†ã€‚ image")]),t._v(" "),n("p",[t._v("CPU æ¶ˆè€—åˆ†æ\né€‰æ‹©ä¸Šä¼ æ–‡ä»¶ï¼Œé€‰æ‹©cpu profileï¼Œä¸Šä¼ åˆšæ‰çš„cpuå¿«ç…§ã€‚")]),t._v(" "),n("p",[t._v("image")]),t._v(" "),n("p",[t._v("ç‚¹å‡»åˆ†æ image")]),t._v(" "),n("p",[t._v("æŸ¥çœ‹ç«ç„°å›¾ image")]),t._v(" "),n("p",[t._v("ç‚¹å‡»åˆ†æï¼ˆdevtoolï¼‰ï¼Œå’Œchromeé¢æ¿ä¸€æ ·ï¼Œä¸è¿‡ä¼šçº¢è‰²æ˜¾ç¤ºå¯èƒ½å¼‚å¸¸çš„function image")]),t._v(" "),n("p",[t._v("ä¸€ä¸ªçœŸå®çš„æ¡ˆä¾‹\nkepler çº¿ä¸ŠæœåŠ¡å¤§é‡502ï¼Œæ˜¯AGè®¿é—®kepler serverå¾—ä¸åˆ°å“åº”ï¼Œkepler server éƒ¨ç½²åï¼Œå†…å­˜æ¶ˆè€—ä¸¥é‡ï¼Œæ‹–æ…¢ç¨‹åºè¿è¡Œï¼Œå¯¼è‡´å¤§é‡é“¾æ¥å“åº”è¶…è¿‡10sã€‚")]),t._v(" "),n("p",[t._v("é€šè¿‡alinodeå¯¹æµ‹è¯•æœåŠ¡å™¨ä¸ŠæœåŠ¡è¿›è¡Œç›‘æ§ï¼Œå¹¶å–å †å¿«ç…§ã€‚å‘ç°nodeç¨‹åº92%çš„å†…å­˜éƒ½æ¥æºäºä¸€ä¸ªArrayæ•°ç»„ï¼Œå¹¶æŒ‡å‘é…ç½®æ–‡ä»¶ app.jsonï¼Œ")]),t._v(" "),n("p",[t._v("image")]),t._v(" "),n("p",[t._v("image")]),t._v(" "),n("p",[t._v("æŸ¥çœ‹ç›¸å…³ä»£ç ï¼Œå‘ç°åœ¨ä»£ç å¦‚ä¸‹")]),t._v(" "),t._m(12),t._v(" "),n("p",[t._v("æŸ¥çœ‹ç½‘ä¸Šç›¸å…³ require.cache æ–‡ç« å‘ç°æ­¤é—®é¢˜æœ‰äººè¸©è¿‡ï¼Œå…·ä½“è§£é‡Šï¼š")]),t._v(" "),n("p",[t._v("node æºç ä¸­å…³äºmodule çš„æ–¹æ³•ï¼Œ")]),t._v(" "),n("p",[t._v("function Module(id, parent) {\nthis.id = id;\nthis.exports = {};\nthis.parent = parent;\nif (parent && parent.children) {\nparent.children.push(this);\n}")]),t._v(" "),n("p",[t._v("this.filename = null;\nthis.loaded = false;\nthis.children = [];\n}\nnode åœ¨ module.js ä¸­è‡ªåŠ¨ä¸ºæ¨¡å—æ·»åŠ äº†å¼•ç”¨")]),t._v(" "),n("p",[t._v("delete require.cache ä»…ä»…æ¸…é™¤æ‰äº† Module._cache å¯¹æ–‡ä»¶ç¬¬ä¸€æ¬¡ require çš„å®ä¾‹çš„å¼•ç”¨\næ­¤æ—¶çˆ¶æ–‡ä»¶ require å®ä¾‹çš„ children æ•°ç»„ä¸­çš„ç¼“å­˜çš„å¼•ç”¨ä¾æ—§å­˜åœ¨ ä¸‹ä¸€æ¬¡ å† require æ­¤æ–‡ä»¶æ—¶ï¼Œç”±äº Module._cache ä¸­ä¸å­˜åœ¨ï¼Œä¼šå†ç”Ÿæˆä¸€æ¬¡æ–‡ä»¶å¯¹åº”çš„ Module å®ä¾‹ï¼ŒåŒæ—¶ç»™å…¶çˆ¶æ–‡ä»¶å®ä¾‹çš„ children æ•°ç»„å†å¢åŠ ä¸€ä¸ªå¼•ç”¨ï¼Œè¿™æ ·å°±é€ æˆäº†æ³„æ¼ã€‚")]),t._v(" "),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"ä»€ä¹ˆæ˜¯alinode"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä»€ä¹ˆæ˜¯alinode","aria-hidden":"true"}},[this._v("#")]),this._v(" ä»€ä¹ˆæ˜¯alinode")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"node-æ€§èƒ½ä¼˜åŒ–ä¸é—®é¢˜æ’æŸ¥"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node-æ€§èƒ½ä¼˜åŒ–ä¸é—®é¢˜æ’æŸ¥","aria-hidden":"true"}},[this._v("#")]),this._v(" Node æ€§èƒ½ä¼˜åŒ–ä¸é—®é¢˜æ’æŸ¥")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("æœåŠ¡æ€§èƒ½æŒ‡æ ‡")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"ååé‡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ååé‡","aria-hidden":"true"}},[this._v("#")]),this._v(" ååé‡")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("QPS (TPS)ï¼šæ¯ç§’æŸ¥è¯¢ç‡QPSæ˜¯å¯¹ä¸€ä¸ªç‰¹å®šçš„æŸ¥è¯¢æœåŠ¡å™¨åœ¨è§„å®šæ—¶é—´å†…æ‰€å¤„ç†æµé‡å¤šå°‘çš„è¡¡é‡æ ‡å‡†ï¼Œé€šå¸¸ç”¨æ¥è¡¨è¾¾å’Œè¡¡é‡å½“å‰ç³»ç»Ÿçš„è´Ÿè½½")])]),this._v(" "),s("li",[s("p",[this._v("å¹¶å‘æ•°ï¼šç³»ç»ŸåŒæ—¶å¤„ç†çš„request/äº‹åŠ¡æ•°")])]),this._v(" "),s("li",[s("p",[this._v("å“åº”æ—¶é—´ï¼šä¸€èˆ¬å–å¹³å‡å“åº”æ—¶é—´")])]),this._v(" "),s("li",[s("p",[this._v("å…³ç³»ï¼š QPS = å¹¶å‘é‡ / å¹³å‡å“åº”æ—¶é—´\nä¸€ä¸ªç³»ç»Ÿååé‡é€šå¸¸ç”±QPSï¼ˆTPSï¼‰ã€å¹¶å‘æ•°ä¸¤ä¸ªå› ç´ å†³å®šï¼Œæ¯å¥—ç³»ç»Ÿè¿™ä¸¤ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ªç›¸å¯¹æé™å€¼ï¼Œåœ¨åº”ç”¨åœºæ™¯è®¿é—®å‹åŠ›ä¸‹ï¼Œåªè¦æŸä¸€é¡¹è¾¾ åˆ°ç³»ç»Ÿæœ€é«˜å€¼ï¼Œç³»ç»Ÿçš„ååé‡å°±ä¸Šä¸å»äº†ï¼Œå¦‚æœå‹åŠ›ç»§ç»­å¢å¤§ï¼Œç³»ç»Ÿçš„ååé‡åè€Œä¼šä¸‹é™ï¼ŒåŸå› æ˜¯ç³»ç»Ÿè¶…è´Ÿè·å·¥ä½œï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢ã€å†…å­˜ç­‰ç­‰å…¶å®ƒæ¶ˆè€—å¯¼è‡´ç³»ç»Ÿæ€§èƒ½ä¸‹ é™!")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"å†…å­˜æ³„éœ²"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜æ³„éœ²","aria-hidden":"true"}},[this._v("#")]),this._v(" å†…å­˜æ³„éœ²")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"æ€§èƒ½ä¼˜åŒ–"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ€§èƒ½ä¼˜åŒ–","aria-hidden":"true"}},[this._v("#")]),this._v(" æ€§èƒ½ä¼˜åŒ–")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("code",[this._v("v8::Isolate::GetCurrent()->GetHeapProfiler()->TakeHeapSnapshot(title, control)")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("å¿«ç…§\næˆ‘ä»¬ä¸ºç¨‹åºæ·»åŠ ä¸€ä¸ªè¿›è¡Œå¿«ç…§çš„è·¯ç”±ï¼Œåœ¨æœåŠ¡ä¸€å¼€å§‹è¿è¡Œçš„æ—¶å€™å¼€å§‹CPUåˆ†æå¹¶è¿›è¡Œç¬¬ä¸€æ¬¡å †å¿«ç…§ï¼Œæ–¹ä¾¿åé¢å¯¹æ¯”ï¼ŒæœåŠ¡ç«¯æ¥å—åˆ°è¿™ä¸ªGetè¯·æ±‚æ—¶ï¼Œè¿›è¡Œåœæ­¢åˆ†æï¼Œå¹¶è¿›è¡Œå †å¿«ç…§å’ŒCPUå¿«ç…§ï¼Œä¿å­˜å¿«ç…§æ–‡ä»¶ã€‚")])])},function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"language-js extra-class"},[n("pre",{pre:!0,attrs:{class:"language-js"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" profiler "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'v8-profiler'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nprofiler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("startProfiling")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" snapshot1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" profiler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("takeSnapshot")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nrouter"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/profiler'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("ctx")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" perf "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" profiler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("stopProfiling")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  perf\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWriteStream")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'profiler.cpuprofile'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'finish'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" perf"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" snapshot2 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" profiler"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("takeSnapshot")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  snapshot1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" result")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" console"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeFileSync")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'snapshot1.heapsnapshot'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" result"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    snapshot1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("delete")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  snapshot2\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("export")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("pipe")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWriteStream")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'snapshot2.heapsnapshot'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'finish'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" snapshot2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("delete"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("body "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    msg"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'success take profile'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[this._v("åˆ†æ\nåˆ†ææ–¹å¼å¯ä»¥ä½¿ç”¨chrome devtoolsè¿›è¡Œåˆ†æï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨alinodeè¿›è¡Œåˆ†æ")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",{attrs:{start:"2"}},[s("li",[this._v("ä½¿ç”¨alinodeè¿›è¡Œåˆ†æï¼ˆå¼ºçƒˆæ¨èï¼‰\né˜¿é‡Œäº‘ç™»å½• - æ¬¢è¿ç™»å½•é˜¿é‡Œäº‘ï¼Œå®‰å…¨ç¨³å®šçš„äº‘è®¡ç®—æœåŠ¡å¹³å°")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("//\ndelete require.cache[require.resolve('../configuration/app.json')];"),s("br"),this._v("\nconst { duration } = require('../configuration/app.json');\napp.jsonæ˜¯å¯é…ç½®çš„ï¼Œå¦‚æœä½¿ç”¨requireä¼šæœ‰ç¼“å­˜é—®é¢˜ï¼Œå› æ­¤ä½¿ç”¨äº†delete require.cacheï¼Œç»“æœå¼•èµ·äº†å†…å­˜æ³„éœ²ã€‚")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Node æ€§èƒ½ä¼˜åŒ–ä¸é—®é¢˜æ’æŸ¥ï¼šhttps://topgrd.me/post/5/")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Node.js æ€§èƒ½å¹³å°æ–‡æ¡£ï¼šhttps://help.aliyun.com/product/60298.html?spm=5176.179584.935956.btn2.64bb5d0bJxau20")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Egg.js æ¡†æ¶é›†æˆé˜¿é‡Œ Node.js æ€§èƒ½å¹³å° alinodeï¼šhttps://www.jianshu.com/p/f39b55f8f164")])])}],!1,null,null,null);s.default=e.exports}}]);